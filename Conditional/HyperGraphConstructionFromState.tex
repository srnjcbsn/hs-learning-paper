\documentclass[../Master.tex]{subfiles}
\providecommand{\master}{..}
\begin{document}

Given a state transition $\left( s, a ,s' \right)$

% \begin{algorithm}
%     \caption{Constructing hypergraphs from a state}\label{algo:HypGraphCtor}
%     \begin{algorithmic}
%         \Function{$\textsc{ConstructHyperGraph}$} {$s$, $s'$, \texttt{HyperGraph} $U$, $K$}
%             \ForAll{grounded predicates $q \left( o_1, \dots, o_{|q|} \right) \in s'$}
%                 \ForAll{object $o \in o_1,\dots,o_{|q|}$}
%                     \State{$v \gets Vertex 
%                 \EndFor%
%             \EndFor%
%         \EndFunction%
%     \end{algorithmic}
% \end{algorithm}

\begin{algorithm}
    \caption{Algorithm for learning conditional effects using hypergraphs}\label{algo:CondEffLearn}
    \begin{algorithmic}
        \Function{$\textsc{Conditional-Effect-Learn}$} {$\left( s, a, s'\right)$, \texttt{HyperGraph} $U$, $K$}
            \If {$s' \neq s$}
                \State $C \gets C \cup \{ c(s) \}$
            \ElsIf {$s' = s$}
                \State $D \gets D \cup d(s)$
            \EndIf

            \State Reduce candidate sets by removing predicates disproven to preconditions:
            \State $C' \gets \left\{ c \setminus D \; | \; c \in C' \right\}$

            \State Add singleton sets from $C$ to $K$:
            \State $K' \gets K \cup \left\{ p \; | \; \{ p \} \in C' \right\}$

            \State Remove candidate sets containing predicates proven to be preconditions:
            \State $C' \gets \left\{ c \; | \; c \in C' \land c \cap K \neq \emptyset \right\}$
            \State \Return $(K', D', C')$
        \EndFunction%
    \end{algorithmic}
\end{algorithm}

\textsc{\texttt{Work in progress}}

<TODO: Include explanation of how proven effects are combined with the hypergraphs of the preconditions>

<TODO: Explain how there are many hypergraphs in one state, I.E. each effect contains its own hypergraph of preconditions>

Given a state transition $(s,a,s')$:

(TO Thomas this is a very condensed form of what will be written)
find all predicates in $\Delta s = s \setminus s'$. For each effect predicate, find predicates that are connected to it, and build a hypergraph from this information (after applying a substitution to reduce it to variable form). 

For each effect with the same predicate form (ie. $p(x,y)$ has the same form as $p(y,x)$, but not the same form as $p(x,x)$ or $q(x,y)$), merge their hyper graphs as described in the next section. 

Then merge the resulting hypergraphs with prior knowledge (which is also a hypergraph).

When a conditional action fails:

As for non-conditional actions, we will introduce the notion of a candidate set for proving preconditions. In contrast to non-conditional actions, the preconditions we wish to prove are bindings between variables. 

Whenever a conditional effect fails, the 

\end{document}
